
@using Microsoft.AspNet.Identity
@if (Request.IsAuthenticated)
{
    using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
    {
        @Html.AntiForgeryToken()

        <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><b>@User.Identity.GetUserName()</b> <span class="caret"></span></a>
                <ul id="login-dp" class="dropdown-menu">
                    <li>
                       
                        @Html.ActionLink("Thông tin cá nhân", "UpdateProfile", "Manage")
                    </li>
                    @if (User.IsInRole("Admin") || User.IsInRole("Administrator"))
                    {
                        <li><a href='@Url.Action("Index", "Home", new { homepage=false})'>Trang admin</a></li>
                    }
                    
                    <li>

                        @Html.ActionLink("Danh sách bài nhận xét", "MyListReview", "Manage")
                    </li>
                    <li><a href="javascript:document.getElementById('logoutForm').submit()">Đăng xuất</a></li>

                </ul>
            </li>                     
        </ul>
    }
}
else
{

    <li class="dropdown" id="login-dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" onclick="openLoginDialog()"><b>Đăng nhập</b> <span class="caret"></span></a>
        <ul id="login-dp" class="dropdown-menu  dropdown-menu-right">
           <li id="login-body"></li>
        </ul>
        <script>

    function openLoginDialog() {

        $.ajax({
            url: '@Url.Action("Login", "Account")',
            contentType: 'application/html',
            data: {returnurl: window.location.href},
            success: function (content) {
                $('#login-body').html(content);
            },
            error: function (e) { alert("Failure!"); }
        });
    }
        </script>

    </li>

}


@if ((Session["OpenAuthorizationPopup"] ?? "false") == "true")
{
    Session["OpenAuthorizationPopup"] = "false";
    <script>
        openLoginDialog();
    </script>
}




